---
title: 'CPanel: Obtenez des certificats SSL gratuits (non-root)'
description: On utilise le script acme
date: 2022-05-01
published: true
image: ../../src/images/blog/keys.jpg
embeddedImagesLocal:
  - cpanel.png
---

import { GatsbyImage, getImage } from 'gatsby-plugin-image';

# CPanel: Obtenez des certificats SSL gratuits (non-root)

Depuis quelques hÃ©bergements partagÃ©s sont liÃ©s seulement dâ€™une option dâ€™acheter un certificat SSL, Ã  lâ€™aide dâ€™un script, on peut gÃ©nÃ©rer des certificats SSL en suivant les instructions.

## ğŸ“ˆ Allez au terminal dans ton CPanel ou SSH lÃ 

<GatsbyImage image={getImage(props.localImages[0])} alt="CPanel" />

## â¬‡ï¸ Obtiens le script [acme.sh](http://acme.sh/)

```bash
curl https://get.acme.sh | sh
```

## ğŸ”ƒ Actualise le terminal

Rentre dans le terminal ou simplement exÃ©cute

```bash
source ~/.bashrc
```

## âœ‰ï¸ Registre ton courriel avec le certificat

```bash
acme.sh â€”-register-account â€”-accountemail youremail@yourdomain.com
```

## â°Â VÃ©rifie si le cronjob a Ã©tÃ© habilitÃ© par acme

```bash
crontab -l | grep acme.sh
```

La commande ci-dessus devrait montrer quelque chose comme:

```bash
10 0 * * * â€œ/home/*YOUR_CPANEL_USER*/.acme.shâ€/acme.sh â€”- cron â€”- home â€œ/home/*YOUR_CPANEL_USER*/.acme.shâ€ > /dev/null
```

## ğŸ“¦ DÃ©finis les variables dans le terminal

```bash
export DOMAIN=yourdomain.com
# Presse enter puis Ã©cris
export WWWDOMAIN=www.yourdomain.com
# N'oublie pas presser enter encore
```

## ğŸ”‘ Teste si la gÃ©nÃ©ration de certificat fonctionne

Avant de tester si la generation de certificat est autorisÃ©e. Tu as besoin du rÃ©pertoire de domaine / sous-domaine dans ton CPanel. ExÃ©cute les commands suivants pour obtenir le rÃ©pertoire.

```bash
export DOMAINPATH=$(uapi DomainInfo single_domain_data domain=$DOMAIN | grep documentroot| cut -d " " -f 6)
```

Le rÃ©sultat sera stockÃ© dans **DOMAINPATH**.

Et puis, tu peux utiliser Acme pour gÃ©nÃ©rer un certificat **STAGING**.

```bash
acme.sh â€”-issue â€”-webroot ${DOMAINPATH} -d ${DOMAIN} -d ${WWWDOMAIN} â€”-staging
```

> Nâ€™oublie pas de seulement ajouter `-d $WWWDOMAIN`, si tu utilises un alias `www` pour ton domaine.

Si tu as reÃ§u des checks / messages verts. FÃ©licitations! Maintenant tu peux gÃ©nÃ©rer de certificats dans CPanel.

## ğŸ„ GÃ©nÃ©rer un certificat SSL rÃ©el

```bash
acme.sh â€”-issue â€”-webroot ${DOMAINPATH} -d ${DOMAIN} -d ${WWWDOMAIN} â€”-force
```

## â•Â Ajoute ton certificat dans CPanel

```bash
acme.sh â€”-deploy â€”-deploy-hook cpanel_uapi â€”-domain ${DOMAIN} --domain ${WWWDOMAIN}
```

> Garde Ã  lâ€™esprit, tu devrais rÃ©pÃ©ter chaque Ã©tape depuis â€œDÃ©finis les variables dans le terminalâ€ et continuer par chaque domaine / sous-domaine lorsque les ajoutes.
