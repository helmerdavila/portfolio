---
title: RÃ©soudre lâ€™erreur 500 dans Laravel Dusk
description: Câ€™est un problÃ¨me entre Larave Dusk et la version du navigateur
date: 2022-06-10
published: true
image: ../../src/images/blog/dusk.jpg
imageAlt: Photo by joe ting on Unsplash
tags: ['laravel', 'php', 'dusk', 'testing', 'phpunit']
---

# RÃ©soudre lâ€™erreur 500 dans Laravel Dusk

## ğŸ¤” Comment est-ce que Ã§a mâ€™est arrivÃ©?

Jâ€™ai essayÃ© de tester un nouveau framework diffÃ©rent que Cypress. Depuis que jâ€™ai de lâ€™expÃ©rience dans Laravel PHP. Laravel Dusk ressemblait comme un outil trÃ¨s facile pour installer. Jâ€™ai suivi les instructions dans le site web, mais jâ€™ai dÃ©couvert un bogue qui se produit de temps en temps parmi les dÃ©veloppeurs.

Fondamentalement, quand la version de navigateur que Laravel Dusk utilise est diffÃ©rente de celle du systÃ¨me, câ€™est quand lâ€™erreur apparaÃ®t. Pire, si tu utilises Chromium au lieu de Chrome, il y a une grande chance qui se produit frÃ©quemment.

Donc, on va voir les instructions pour Ã©viter Ã§a.

## ğŸ‘Ÿ Le moyen le plus rapide

- Si tu travailles sur ton environnement local. Installe Google Chrome et utilise `php artisan dusk:chrome-driver <la_version_de_chrome>`
- Si tu veux exÃ©cuter la commande dans ton serveur de testing / CI-CD, tu dois y installer Google Chrome au lieu de Chromium.

## ğŸ”¨ La solution

Tout dâ€™abord, tu verras le message dâ€™erreur suivant.

```bash
Tests\Browser\ExampleTest::testBasicExample
Facebook\WebDriver\Exception\WebDriverCurlException: Curl error thrown for http POST to /session/d0eec334e467fffaf17d330d553bdbcc/url with params
```

Donc, les Ã©tapes Ã  faire sont:

- DÃ©sinstaller un autre navigateur, comme Chromium.
- On va utiliser la commande de Laravel Dusk pour installer la bonne version du driver
- Avoir Google Chrome installÃ© (la derniÃ¨re version ou au moins une que nâ€™est pas trop vieille)

### â“Et si jâ€™utilise un pipeline dans le CI/CD

Ã‡a mâ€™est arrivÃ© dans Github Actions. Ci-dessous les lignes de code que mâ€™ont aidÃ© Ã  rÃ©soudre le problÃ¨me. Faisons comme si nous utilisons Ubuntu, mais Ã§a doit fonctionner sÃ»r dâ€™autre _Operating System. Les Ã©tapes sont: tÃ©lÃ©charger et installer le binaire de Google Chrome._

```yaml
- name: TÃ©lÃ©charger Chrome
  run: wget -O $HOME/chrome.deb https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb
- name: Installer Chrome
  run: sudo apt install $HOME/chrome.deb
```

### âš™ï¸ La commande dans Laravel Dusk

Avec Laravel Dusk installÃ©, maintenant on peut exÃ©cuter la commande prochaine:

```bash
php artisan dusk:chrome-driver <la_version_de_chrome>
```

Quâ€™est-ce que Ã§a fait exactement? Elle va Ã  installer le driver de Chrome pour Laravel Dusk qui fait la connexion possible entre les fonctions du navigateur et tes tests. Il y a deux options dans la commande. Tu peux Ã©crire la version du navigateur que tu utilises, ou tu peux passer lâ€™option `--detect`. Laravel va dÃ©tecter la version de Chrome et lâ€™installer. Voici une liste dâ€™exemples.

```bash
# Si tu utilises Google Chrome 99, tu peux installer le driver pour cette version
php artisan dusk:chrome-driver 99

# On va dÃ©tecter la version de Chrome depuis le SO
php artisan dusk:chrome-driver --detect
```

Et voilÃ , ce sont toutes les Ã©tapes que jâ€™ai suivies. Si je trouve dâ€™autres faÃ§ons pour le rÃ©soudre, je vais les ajouter.
